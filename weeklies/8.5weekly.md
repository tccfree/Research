## [《Hand pose estimation via latent 2.5d heatmap regression》](https://arxiv.org/pdf/1804.09534.pdf)
![](/picture/10.png)

**这是 ECCV 2018 的一篇文章，提出了一种通过 novel 2.5D pose representation 从 monocular image 获得 3D pose estimation 的方法，文章的亮点和值得注意的地方如下：**

* 从 monocular image 估计 3D pose 存在 scale 和 depth 方面的 ambiguity，所以文章提出的方法将问题分解为两个子问题，2.5D representation 包含两个方面的内容：
    >It consists of 2D coordinates of the hand keypoints in the input image, and scale normalized depth for each keypoint relative to the root (palm). 

* pose estimation 主要有两种方法： heatmap regression 和 holistic pose regression，在 2D pose estimation 上 heatmap regression 可以以像素精度确定 keypoints 于是成为主流的方法；而在 3D pose estimation 上若还使用 volumetric heatmap 则会导致运算开销过大，所以主流的方法使用 holistic regression，但是精度较差，且受限于估计的 2D keypoints 的精度。文章提出的方法主要基于 heatmap 但是规避了它的缺点，保留了其理论上像素级精度的优点。

* 文章提出使用 CNN 结构来学习 2.5D heatmaps，invariant to scale and translation，再通过一个可导的 soft-argmax 函数将 2.5D heatmaps 转换成 2.5D coordinates。

* 文章在 related work 部分总结了从 2D 得到 3D pose 以及直接从图像获得 3D pose 两种不同的方式的一些工作。这里文章提出的方法受到了 multi-task setup to jointly estimate both 2D keypoint locations and 3D pose 思想的启发。

* 文章提出的 2.5D representation 具有 scale-nomalized 特性，从 2.5D 到 3D 过程只需要确定 global scale 而不需要其他的 assumption。

* 文章主要利用了 perspective projection 也就是 pinhole camera model 来建立 2D pixel coordinates 和 3D camera coordinates 之间的关系，注意到小孔成像的原理，因此 scale normalize 之后 2.5D representaion 的 pixel coordinates 并不改变，只有相对 root keypoint 的 depth 会相应改变。确定了 2.5D representation 之后，由于规定了scale，所以可以唯一确定 root keypoint 的 depth。

* 文章为训练设计的 loss 包含了 2.5D representation 的两个部分，这样可以充分利用不同的数据集，没有 3D 标签的数据集也可以参与训练。

* 文章指出 direct 2.5D heatmap regression 中 hand-designed target heatmap 存在缺陷，不同的部位，如 finger-tips 应该相比 palm 更加 peaky；其次 depth prediction 中使用 Gaussian distribution 不合理，如手掌部位的 dpeth 变化不大。所以文章提出的方法学习 latent representaion of 2.5D heatmaps，由此恢复出 probability map 用来得到 2D keypoint 和 depth value。

***小节：通过阅读这篇文章对于 pinhole camera model 的成像过程和数学关系有了更加深入的了解。***

## [《Model-Based 3D Hand Pose Estimation from Monocular Video》]()
![]()

**这是雨劲师兄推荐的一篇TPAMI 2011 的一篇文章，主要介绍了一种从视频进行 3D hand tracking 的方法，文章的亮点和值得注意的地方如下：**

* 文章认为 vision-based hand tracking 面临的问题主要是：1、high degree of freedom；2、availablity visual cues。尤其是第二点，作者认为轮廓和边缘提供的信息有限，提出了新的观点，认为对于手这样的物体 shading 是较为关键的视觉信息。

* 文章简单介绍了 discriminative 和 generative model 的概念，并提出了一种基于 genrative model 的 analysis-by-synthesis 的方法，将 shading 和 texture 的信息都容纳进来。

* 文章提出了一种 novel detailed derivartion of gradient in the vicinity of depth discontinuities，探究由于 occlusions 造成的，体现在 gradient 中的重要信息。

* 文章采用了 adpative albedo function 来 model texture（albedo variance）和其他可能的 hand appearance properties来；并且提到了通过 multiply reflectance 和 irradiance 可以得到 appearance of the point on surface。其中 illuminant model 可以用 4D vector 表示，irradiance 可以使用 ambient coefficient 加上 surface 法向量和 distant point direction 的标量积来表示。illuminant model 和 irradiance 的原文描述如下：
    >"The illuminant model includes ambient light and a distant point source, and is specified by a 4D vector denoted by L, comprising three elements for a directional component, and one for an ambient component."

    >"The irradiance at each vertex of the surface mesh is obtained by the sum of the ambient coefficient and the scalar product between the surface normal at the vertex and the light source direction. The irradiance across each face is then obtained through bilinear inter- polation."

* 在 texture model 上，首先文章采用了双线性插值保证了 facet 内部的连续性；但是由于手的拓扑结构不是圆盘，不能简单定义一个 surface 到 2D planar surface 的 bijective mapping，文章进一步采用了 patch-based texture mapping，每个 facet 被关联到一个 triangular region，由于在 edge 可以由相邻的两个 patch 分别得到，为了保证 consistency，文章又对于 texture map 增加了两个 linear constraints：第一个保证了 integer-coordinate 点 intensity 的一致性，第二个保证了在 diagonal edge 上进行双线性插值的的时候会和 horizontal or vertical edge 一样都对位置参数呈线性关系，从而保证了 non-integer coordinate 的一致性，这一步推导的过程直接令二阶导数为零，比较巧妙。尚存的问题是一个 facet 有三个 adjacent facet，那么按文章提出的方法，是否一个 facet 要在 texture map 中出现三次？

* 给定 mesh geometry，illuminant 和 texture map，可以通过 ray-tracing 确定 generative model 生成的 model image。

* 在 objective fuction 的设计上，文章提出了 discrepancy measure E：首先定义了一个 residual image R，再将 integral of the residual error 定义为需要 minimize 的 discrepancy measure E。文章指出可以通过转换积分域，将 hand region 内部的 integral of residual error 转换成 visible part of surface 上的连续积分，进而可以用 finite weighted sum over centers of visible faces来 表示；但是这种离散化的方法相当于是二值化 facet 的 visibility，所以会使  objective funtion 关于 ![](http://latex.codecogs.com/gif.latex?\theta) 不连续,对 gradient-based optimization 带来影响，所以文章在计算 functional gradient 的时候将 formulation 定义在连续的 image domain 上。

* 文章指出 parameter estimation 不能通过简单的 global optimization 得到，要采用 quasi-Newton，local optimization 的方法，但仍需要提供 discrepancy measure E 关于 pose parameters ![](http://latex.codecogs.com/gif.latex?\theta) 和 illuminant parameters L 的导数；其中后者的计算直接使用 chain rule 即可，但是关于 pose paramters 导数的估计由于 residual error 在边界上关于 pose 不连续，不可导，所以不能简单通过 chain rule 得到。

* 文章指出在 self-occlusion 和 occlusion boundaries 处 residual error 不连续，为了能推导出连续情况下 gradient of E with respect to ![](http://latex.codecogs.com/gif.latex?\theta) ,文章分别对 1D 和 2D 的情况做了说明，通过对 boundary 处做一些处理，虽然 residual error 不连续，但是积分得到的 objective function 依然是关于 ![](http://latex.codecogs.com/gif.latex?\theta) 可导的。

* 进一步，文章比较了在 numerical apxroximation to E 的基础上计算 gradient 几种方法，指出直接离散化 gradient of E 的结果与 gradient of approximatin to E 存在系统性差别；另一种方法直接计算 gradient of approximation to E 则由于采样时的 aliasing，会导致 obejective function E 关于 ![](http://latex.codecogs.com/gif.latex?\theta) 不连续。据此，文章提出了一种关于 E 的 differentiable discretization。

* 文章提出的关于 objective function E 的 differentiable discretization 受到了 discontinuity edge overdraw method 方法的启发，通过构造新的 residual function 解决了 aliasing 的问题；主要的思想是建立 anti-aliased region，这个区域内的 points 的 residual 使用 linear combination of the residuals on the occluded and occluding sides。

* 文章在 minimize  objective function E 方面使用了sequential quadratic method with BFGS Hessian approximation；大概的思想应该是通过对 Hessian 的估计得到一个 linearly constrained subspace，在这个 subspace 内沿着 gradient 的方向 update 可以保证 objective function decrease。 这一部分的内容如果有必要可以进一步学习。

* 在 texture update 的过程中，文章提出的方法需要 model texture for hidden area of hand，并且在帧与帧之间更新的时候避免 texture 被无关部分错误影响；所以提出的objective function 在 tracking 的基础上加入了 smoothness regularization term，来 diffuse the color to texels that don’t directly contribute to the image， 并加入了一些 tricks 规避了 boundary inaccurate estimation 对  texture 的影响，增强了robustness。
